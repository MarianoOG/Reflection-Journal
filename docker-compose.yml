services:
  ai-worker:
    build:
      context: ./ai-worker
      dockerfile: Dockerfile
    ports:
      - "8001:8080"
    volumes:
      - ./ai-worker/.env:/app/.env
  audio-to-text:
    build:
      context: ./audio-to-text
      dockerfile: Dockerfile
      args:
        WHISPER_MODELS: "small"
    ports:
      - "8002:8080"
    volumes:
      - ./audio-to-text/.env:/app/.env
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "8000:8080"
    volumes:
      - ./backend/db:/app/db
      - ./backend/.env:/app/.env
    environment:
      AI_WORKER_URL: http://ai-worker:8080
    depends_on:
      - ai-worker
      - audio-to-text
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      BACKEND_URL: http://backend:8080
    depends_on:
      - backend