services:
  ai-worker:
    build:
      context: ./ai-worker
      dockerfile: Dockerfile
    ports:
      - "8001:8080"
    volumes:
      - ./ai-worker/.env:/app/.env
      - ~/.config/gcloud/application_default_credentials.json:/app/credentials.json:ro
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "8000:8080"
    volumes:
      - ./backend/db:/app/db
      - ./backend/.env:/app/.env
      - ~/.config/gcloud/application_default_credentials.json:/app/credentials.json:ro
    environment:
      AI_WORKER_URL: http://ai-worker:8080
    depends_on:
      - ai-worker
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      BACKEND_URL: http://backend:8080
    depends_on:
      - backend